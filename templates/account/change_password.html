<!-- apps/project/templates/account/change_password.html -->
{% extends 'two_factor/_base.html' %}
{% load i18n %}

{% block title %}
  <title>{% trans 'Change Your Password' %}</title>
{% endblock %}

{% block body_properties %}
  style="background-image: linear-gradient(to bottom, #c79c44 0%, #c89d46 50%, #f4d88b 100%);" class="height:100%"
{% endblock %}

{% block layout_content %}
  <div class="min-vh-100 d-flex align-items-center justify-content-center container-xl px-5">
    <div class="card mx-auto" style="max-width: 600px; width: 100%;">
        
      {% if messages %}
        <div class="mt-3">
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <div class="card-header text-center">
            <a href="{% url 'core:index' %}">
                <img src="https://geausa.propensionesabogados.com/public/static/assets/imgs/logos/gea_logo_gold.webp"
                class="card-img-top img-fluid" alt="..." style="max-width: fit-content;" />
            </a>
        </div>

      <div class="card-body">
        <form method="post" novalidate>
          {% csrf_token %}

          {% if form.non_field_errors %}
            <div class="alert alert-danger">
              {% for error in form.non_field_errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}

          <!-- Current Password -->
          <div class="my-2">
            {{ form.old_password }}
            {% if form.old_password.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.old_password.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% endif %}
          </div>

          <div class="row">
            <div class="col-md-6">
              <!-- New Password -->
              <div class="mb-2">
                {{ form.new_password1 }}
                {% if form.new_password1.errors %}
                  <div class="invalid-feedback d-block">
                    {% for error in form.new_password1.errors %}
                      {{ error }}
                    {% endfor %}
                  </div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-6">
              <!-- Confirm New Password -->
              <div class="mb-2">
                {{ form.new_password2 }}
                {% if form.new_password2.errors %}
                  <div class="invalid-feedback d-block">
                    {% for error in form.new_password2.errors %}
                      {{ error }}
                    {% endfor %}
                  </div>
                {% endif %}
              </div>
          </div>

          <div class="form-text my-2">
            <small>
              {% trans 'Your password must contain at least:' %}
              <ul class="mb-0">
                <li>
                  {% trans '8 characters' %}
                </li>
                <li>
                  {% trans '1 uppercase and 1 lowercase letter' %}
                </li>
                <li>
                  {% trans '1 special and 1 number character' %}
                </li>
              </ul>
            </small>
          </div>

          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-success">{% trans 'Change Password' %}</button>
            <a href="{% url 'core:index' %}" class="btn btn-outline-danger">{% trans 'Cancel' %}</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <style>
    .invalid-feedback {
      display: block !important;
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.querySelector('form')
      if (form) {
        form.addEventListener(
          'submit',
          function (event) {
            if (!form.checkValidity()) {
              event.preventDefault()
              event.stopPropagation()
            }
            form.classList.add('was-validated')
          },
          false
        )
      }
    })
  </script>
{% endblock %}
